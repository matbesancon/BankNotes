<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <title>feature_eng</title>
      <style>.markdown-preview, .markdown-preview[data-use-github-style] { font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; font-size: 16px; line-height: 1.6; word-wrap: break-word; overflow: scroll; box-sizing: border-box; padding: 20px; background-color: rgb(255, 255, 255); }
.markdown-preview > :first-child, .markdown-preview[data-use-github-style] > :first-child { margin-top: 0px !important; }
.markdown-preview > :last-child, .markdown-preview[data-use-github-style] > :last-child { margin-bottom: 0px !important; }
.markdown-preview a:not([href]), .markdown-preview[data-use-github-style] a:not([href]) { color: inherit; text-decoration: none; }
.markdown-preview .absent, .markdown-preview[data-use-github-style] .absent { color: rgb(204, 0, 0); }
.markdown-preview .anchor, .markdown-preview[data-use-github-style] .anchor { position: absolute; top: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; }
.markdown-preview .anchor:focus, .markdown-preview[data-use-github-style] .anchor:focus { outline: none; }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1, .markdown-preview h2, .markdown-preview[data-use-github-style] h2, .markdown-preview h3, .markdown-preview[data-use-github-style] h3, .markdown-preview h4, .markdown-preview[data-use-github-style] h4, .markdown-preview h5, .markdown-preview[data-use-github-style] h5, .markdown-preview h6, .markdown-preview[data-use-github-style] h6 { position: relative; margin-top: 1em; margin-bottom: 16px; font-weight: bold; line-height: 1.4; }
.markdown-preview h1 .octicon-link, .markdown-preview[data-use-github-style] h1 .octicon-link, .markdown-preview h2 .octicon-link, .markdown-preview[data-use-github-style] h2 .octicon-link, .markdown-preview h3 .octicon-link, .markdown-preview[data-use-github-style] h3 .octicon-link, .markdown-preview h4 .octicon-link, .markdown-preview[data-use-github-style] h4 .octicon-link, .markdown-preview h5 .octicon-link, .markdown-preview[data-use-github-style] h5 .octicon-link, .markdown-preview h6 .octicon-link, .markdown-preview[data-use-github-style] h6 .octicon-link { display: none; color: rgb(0, 0, 0); vertical-align: middle; }
.markdown-preview h1:hover .anchor, .markdown-preview[data-use-github-style] h1:hover .anchor, .markdown-preview h2:hover .anchor, .markdown-preview[data-use-github-style] h2:hover .anchor, .markdown-preview h3:hover .anchor, .markdown-preview[data-use-github-style] h3:hover .anchor, .markdown-preview h4:hover .anchor, .markdown-preview[data-use-github-style] h4:hover .anchor, .markdown-preview h5:hover .anchor, .markdown-preview[data-use-github-style] h5:hover .anchor, .markdown-preview h6:hover .anchor, .markdown-preview[data-use-github-style] h6:hover .anchor { padding-left: 8px; margin-left: -30px; text-decoration: none; }
.markdown-preview h1:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h1:hover .anchor .octicon-link, .markdown-preview h2:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h2:hover .anchor .octicon-link, .markdown-preview h3:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h3:hover .anchor .octicon-link, .markdown-preview h4:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h4:hover .anchor .octicon-link, .markdown-preview h5:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h5:hover .anchor .octicon-link, .markdown-preview h6:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h6:hover .anchor .octicon-link { display: inline-block; }
.markdown-preview h1 tt, .markdown-preview[data-use-github-style] h1 tt, .markdown-preview h2 tt, .markdown-preview[data-use-github-style] h2 tt, .markdown-preview h3 tt, .markdown-preview[data-use-github-style] h3 tt, .markdown-preview h4 tt, .markdown-preview[data-use-github-style] h4 tt, .markdown-preview h5 tt, .markdown-preview[data-use-github-style] h5 tt, .markdown-preview h6 tt, .markdown-preview[data-use-github-style] h6 tt, .markdown-preview h1 code, .markdown-preview[data-use-github-style] h1 code, .markdown-preview h2 code, .markdown-preview[data-use-github-style] h2 code, .markdown-preview h3 code, .markdown-preview[data-use-github-style] h3 code, .markdown-preview h4 code, .markdown-preview[data-use-github-style] h4 code, .markdown-preview h5 code, .markdown-preview[data-use-github-style] h5 code, .markdown-preview h6 code, .markdown-preview[data-use-github-style] h6 code { font-size: inherit; }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview h1 .anchor, .markdown-preview[data-use-github-style] h1 .anchor { line-height: 1; }
.markdown-preview h2, .markdown-preview[data-use-github-style] h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview h2 .anchor, .markdown-preview[data-use-github-style] h2 .anchor { line-height: 1; }
.markdown-preview h3, .markdown-preview[data-use-github-style] h3 { font-size: 1.5em; line-height: 1.43; }
.markdown-preview h3 .anchor, .markdown-preview[data-use-github-style] h3 .anchor { line-height: 1.2; }
.markdown-preview h4, .markdown-preview[data-use-github-style] h4 { font-size: 1.25em; }
.markdown-preview h4 .anchor, .markdown-preview[data-use-github-style] h4 .anchor { line-height: 1.2; }
.markdown-preview h5, .markdown-preview[data-use-github-style] h5 { font-size: 1em; }
.markdown-preview h5 .anchor, .markdown-preview[data-use-github-style] h5 .anchor { line-height: 1.1; }
.markdown-preview h6, .markdown-preview[data-use-github-style] h6 { font-size: 1em; color: rgb(119, 119, 119); }
.markdown-preview h6 .anchor, .markdown-preview[data-use-github-style] h6 .anchor { line-height: 1.1; }
.markdown-preview p, .markdown-preview[data-use-github-style] p, .markdown-preview blockquote, .markdown-preview[data-use-github-style] blockquote, .markdown-preview ul, .markdown-preview[data-use-github-style] ul, .markdown-preview ol, .markdown-preview[data-use-github-style] ol, .markdown-preview dl, .markdown-preview[data-use-github-style] dl, .markdown-preview table, .markdown-preview[data-use-github-style] table, .markdown-preview pre, .markdown-preview[data-use-github-style] pre { margin-top: 0px; margin-bottom: 16px; }
.markdown-preview hr, .markdown-preview[data-use-github-style] hr { height: 4px; padding: 0px; margin: 16px 0px; border: 0px none; background-color: rgb(231, 231, 231); }
.markdown-preview ul, .markdown-preview[data-use-github-style] ul, .markdown-preview ol, .markdown-preview[data-use-github-style] ol { padding-left: 2em; }
.markdown-preview ul.no-list, .markdown-preview[data-use-github-style] ul.no-list, .markdown-preview ol.no-list, .markdown-preview[data-use-github-style] ol.no-list { padding: 0px; list-style-type: none; }
.markdown-preview ul ul, .markdown-preview[data-use-github-style] ul ul, .markdown-preview ul ol, .markdown-preview[data-use-github-style] ul ol, .markdown-preview ol ol, .markdown-preview[data-use-github-style] ol ol, .markdown-preview ol ul, .markdown-preview[data-use-github-style] ol ul { margin-top: 0px; margin-bottom: 0px; }
.markdown-preview li > p, .markdown-preview[data-use-github-style] li > p { margin-top: 16px; }
.markdown-preview dl, .markdown-preview[data-use-github-style] dl { padding: 0px; }
.markdown-preview dl dt, .markdown-preview[data-use-github-style] dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold; }
.markdown-preview dl dd, .markdown-preview[data-use-github-style] dl dd { padding: 0px 16px; margin-bottom: 16px; }
.markdown-preview blockquote, .markdown-preview[data-use-github-style] blockquote { padding: 0px 15px; color: rgb(119, 119, 119); border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); }
.markdown-preview blockquote > :first-child, .markdown-preview[data-use-github-style] blockquote > :first-child { margin-top: 0px; }
.markdown-preview blockquote > :last-child, .markdown-preview[data-use-github-style] blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview table, .markdown-preview[data-use-github-style] table { display: block; width: 100%; overflow: auto; word-break: keep-all; }
.markdown-preview table th, .markdown-preview[data-use-github-style] table th { font-weight: bold; }
.markdown-preview table th, .markdown-preview[data-use-github-style] table th, .markdown-preview table td, .markdown-preview[data-use-github-style] table td { padding: 6px 13px; border: 1px solid rgb(221, 221, 221); }
.markdown-preview table tr, .markdown-preview[data-use-github-style] table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(255, 255, 255); }
.markdown-preview table tr:nth-child(2n), .markdown-preview[data-use-github-style] table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview img, .markdown-preview[data-use-github-style] img { max-width: 100%; box-sizing: border-box; }
.markdown-preview .emoji, .markdown-preview[data-use-github-style] .emoji { max-width: none; }
.markdown-preview span.frame, .markdown-preview[data-use-github-style] span.frame { display: block; overflow: hidden; }
.markdown-preview span.frame > span, .markdown-preview[data-use-github-style] span.frame > span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0px 0px; overflow: hidden; border: 1px solid rgb(221, 221, 221); }
.markdown-preview span.frame span img, .markdown-preview[data-use-github-style] span.frame span img { display: block; float: left; }
.markdown-preview span.frame span span, .markdown-preview[data-use-github-style] span.frame span span { display: block; padding: 5px 0px 0px; clear: both; color: rgb(51, 51, 51); }
.markdown-preview span.align-center, .markdown-preview[data-use-github-style] span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-center > span, .markdown-preview[data-use-github-style] span.align-center > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: center; }
.markdown-preview span.align-center span img, .markdown-preview[data-use-github-style] span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview span.align-right, .markdown-preview[data-use-github-style] span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview span.align-right > span, .markdown-preview[data-use-github-style] span.align-right > span { display: block; margin: 13px 0px 0px; overflow: hidden; text-align: right; }
.markdown-preview span.align-right span img, .markdown-preview[data-use-github-style] span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview span.float-left, .markdown-preview[data-use-github-style] span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; }
.markdown-preview span.float-left span, .markdown-preview[data-use-github-style] span.float-left span { margin: 13px 0px 0px; }
.markdown-preview span.float-right, .markdown-preview[data-use-github-style] span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; }
.markdown-preview span.float-right > span, .markdown-preview[data-use-github-style] span.float-right > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: right; }
.markdown-preview code, .markdown-preview[data-use-github-style] code, .markdown-preview tt, .markdown-preview[data-use-github-style] tt { padding: 0.2em 0px; margin: 0px; font-size: 85%; border-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157); }
.markdown-preview code::before, .markdown-preview[data-use-github-style] code::before, .markdown-preview tt::before, .markdown-preview[data-use-github-style] tt::before, .markdown-preview code::after, .markdown-preview[data-use-github-style] code::after, .markdown-preview tt::after, .markdown-preview[data-use-github-style] tt::after { letter-spacing: -0.2em; content: " "; }
.markdown-preview code br, .markdown-preview[data-use-github-style] code br, .markdown-preview tt br, .markdown-preview[data-use-github-style] tt br { display: none; }
.markdown-preview del code, .markdown-preview[data-use-github-style] del code { text-decoration: inherit; }
.markdown-preview pre > code, .markdown-preview[data-use-github-style] pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; border: 0px; background: transparent; }
.markdown-preview .highlight, .markdown-preview[data-use-github-style] .highlight { margin-bottom: 16px; }
.markdown-preview .highlight pre, .markdown-preview[data-use-github-style] .highlight pre, .markdown-preview pre, .markdown-preview[data-use-github-style] pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; border-radius: 3px; background-color: rgb(247, 247, 247); }
.markdown-preview .highlight pre, .markdown-preview[data-use-github-style] .highlight pre { margin-bottom: 0px; word-break: normal; }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre { word-wrap: normal; }
.markdown-preview pre code, .markdown-preview[data-use-github-style] pre code, .markdown-preview pre tt, .markdown-preview[data-use-github-style] pre tt { display: inline; max-width: initial; padding: 0px; margin: 0px; overflow: initial; line-height: inherit; word-wrap: normal; border: 0px; background-color: transparent; }
.markdown-preview pre code::before, .markdown-preview[data-use-github-style] pre code::before, .markdown-preview pre tt::before, .markdown-preview[data-use-github-style] pre tt::before, .markdown-preview pre code::after, .markdown-preview[data-use-github-style] pre code::after, .markdown-preview pre tt::after, .markdown-preview[data-use-github-style] pre tt::after { content: normal; }
.markdown-preview kbd, .markdown-preview[data-use-github-style] kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(85, 85, 85); vertical-align: middle; border-style: solid; border-width: 1px; border-color: rgb(204, 204, 204) rgb(204, 204, 204) rgb(187, 187, 187); border-radius: 3px; box-shadow: rgb(187, 187, 187) 0px -1px 0px inset; background-color: rgb(252, 252, 252); }
.markdown-preview, .markdown-preview[data-use-github-style], .markdown-preview code, .markdown-preview[data-use-github-style] code { color: rgb(51, 51, 51); }
.markdown-preview h1, .markdown-preview[data-use-github-style] h1, .markdown-preview h2, .markdown-preview[data-use-github-style] h2, .markdown-preview h3, .markdown-preview[data-use-github-style] h3, .markdown-preview h4, .markdown-preview[data-use-github-style] h4, .markdown-preview h5, .markdown-preview[data-use-github-style] h5, .markdown-preview h6, .markdown-preview[data-use-github-style] h6 { -webkit-font-smoothing: antialiased; cursor: text; }
.markdown-preview > h1:first-child, .markdown-preview[data-use-github-style] > h1:first-child, .markdown-preview > h1:first-child + h2, .markdown-preview[data-use-github-style] > h1:first-child + h2, .markdown-preview > h2:first-child, .markdown-preview[data-use-github-style] > h2:first-child, .markdown-preview > h3:first-child, .markdown-preview[data-use-github-style] > h3:first-child, .markdown-preview > h4:first-child, .markdown-preview[data-use-github-style] > h4:first-child, .markdown-preview > h5:first-child, .markdown-preview[data-use-github-style] > h5:first-child, .markdown-preview > h6:first-child, .markdown-preview[data-use-github-style] > h6:first-child { margin-top: 0px; padding-top: 0px; }
.markdown-preview a, .markdown-preview[data-use-github-style] a, .markdown-preview a code, .markdown-preview[data-use-github-style] a code { color: rgb(65, 131, 196); }
.markdown-preview a:first-child h1, .markdown-preview[data-use-github-style] a:first-child h1, .markdown-preview a:first-child h2, .markdown-preview[data-use-github-style] a:first-child h2, .markdown-preview a:first-child h3, .markdown-preview[data-use-github-style] a:first-child h3, .markdown-preview a:first-child h4, .markdown-preview[data-use-github-style] a:first-child h4, .markdown-preview a:first-child h5, .markdown-preview[data-use-github-style] a:first-child h5, .markdown-preview a:first-child h6, .markdown-preview[data-use-github-style] a:first-child h6 { margin-top: 0px; padding-top: 0px; }
.markdown-preview h1 + p, .markdown-preview[data-use-github-style] h1 + p, .markdown-preview h2 + p, .markdown-preview[data-use-github-style] h2 + p, .markdown-preview h3 + p, .markdown-preview[data-use-github-style] h3 + p, .markdown-preview h4 + p, .markdown-preview[data-use-github-style] h4 + p, .markdown-preview h5 + p, .markdown-preview[data-use-github-style] h5 + p, .markdown-preview h6 + p, .markdown-preview[data-use-github-style] h6 + p { margin-top: 0px; }
.markdown-preview li p.first, .markdown-preview[data-use-github-style] li p.first { display: inline-block; }
.markdown-preview ul, .markdown-preview[data-use-github-style] ul { list-style-type: disc; }
.markdown-preview ol, .markdown-preview[data-use-github-style] ol { list-style-type: decimal; }
.markdown-preview ul li > :first-child, .markdown-preview[data-use-github-style] ul li > :first-child, .markdown-preview ol li > :first-child, .markdown-preview[data-use-github-style] ol li > :first-child, .markdown-preview ul li ul:first-of-type, .markdown-preview[data-use-github-style] ul li ul:first-of-type, .markdown-preview ol li ul:first-of-type, .markdown-preview[data-use-github-style] ol li ul:first-of-type { margin-top: 0px; }
.markdown-preview ol > li, .markdown-preview[data-use-github-style] ol > li { list-style-type: inherit; }
.markdown-preview ul > li, .markdown-preview[data-use-github-style] ul > li { list-style-type: inherit; }
.markdown-preview dl dt:first-child, .markdown-preview[data-use-github-style] dl dt:first-child { padding: 0px; }
.markdown-preview dl dt > :first-child, .markdown-preview[data-use-github-style] dl dt > :first-child { margin-top: 0px; }
.markdown-preview dl dt > :last-child, .markdown-preview[data-use-github-style] dl dt > :last-child { margin-bottom: 0px; }
.markdown-preview dl dd > :first-child, .markdown-preview[data-use-github-style] dl dd > :first-child { margin-top: 0px; }
.markdown-preview dl dd > :last-child, .markdown-preview[data-use-github-style] dl dd > :last-child { margin-bottom: 0px; }
.markdown-preview blockquote p, .markdown-preview[data-use-github-style] blockquote p { font-size: 16px; line-height: 1.5; }
.markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { padding: 16px; overflow: auto; font-size: 84%; line-height: 1.45; border-radius: 3px; background-color: rgb(255, 255, 255); }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre, .markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { margin-bottom: 16px; word-break: normal; }
.markdown-preview pre, .markdown-preview[data-use-github-style] pre, .markdown-preview code, .markdown-preview[data-use-github-style] code, .markdown-preview tt, .markdown-preview[data-use-github-style] tt, .markdown-preview pre.editor-colors, .markdown-preview[data-use-github-style] pre.editor-colors { font-family: Consolas, 'Liberation Mono', Courier, monospace; }
.markdown-preview .emoji, .markdown-preview[data-use-github-style] .emoji { height: 20px; width: 20px; }
.markdown-preview del, .markdown-preview[data-use-github-style] del { text-decoration: none; position: relative; }
.markdown-preview del::after, .markdown-preview[data-use-github-style] del::after { border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: black; content: ""; left: 0px; position: absolute; right: 0px; top: 50%; }
.markdown-preview .flash, .markdown-preview[data-use-github-style] .flash { animation: flash 1s ease-out 1; outline: rgba(255, 0, 0, 0) solid 1px; }
.markdown-preview .flash:not(li), .markdown-preview[data-use-github-style] .flash:not(li) { display: block; }
.markdown-preview:not([data-use-github-style]) { padding: 2em; font-size: 1.2em; color: rgb(85, 85, 85); overflow: auto; background-color: rgb(255, 255, 255); }
.markdown-preview:not([data-use-github-style]) > :first-child { margin-top: 0px; }
.markdown-preview:not([data-use-github-style]) h1, .markdown-preview:not([data-use-github-style]) h2, .markdown-preview:not([data-use-github-style]) h3, .markdown-preview:not([data-use-github-style]) h4, .markdown-preview:not([data-use-github-style]) h5, .markdown-preview:not([data-use-github-style]) h6 { line-height: 1.2; margin-top: 1.5em; margin-bottom: 0.5em; color: rgb(3, 3, 3); }
.markdown-preview:not([data-use-github-style]) h1 { font-size: 2.4em; font-weight: 300; }
.markdown-preview:not([data-use-github-style]) h2 { font-size: 1.8em; font-weight: 400; }
.markdown-preview:not([data-use-github-style]) h3 { font-size: 1.5em; font-weight: 500; }
.markdown-preview:not([data-use-github-style]) h4 { font-size: 1.2em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) h5 { font-size: 1.1em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) h6 { font-size: 1em; font-weight: 600; }
.markdown-preview:not([data-use-github-style]) strong { color: rgb(3, 3, 3); }
.markdown-preview:not([data-use-github-style]) del { color: rgb(126, 126, 126); }
.markdown-preview:not([data-use-github-style]) a, .markdown-preview:not([data-use-github-style]) a code { color: rgb(0, 0, 0); }
.markdown-preview:not([data-use-github-style]) img { max-width: 100%; }
.markdown-preview:not([data-use-github-style]) > p { margin-top: 0px; margin-bottom: 1.5em; }
.markdown-preview:not([data-use-github-style]) > ul, .markdown-preview:not([data-use-github-style]) > ol { margin-bottom: 1.5em; }
.markdown-preview:not([data-use-github-style]) blockquote { margin: 1.5em 0px; font-size: inherit; color: rgb(126, 126, 126); border-color: rgb(214, 214, 214); border-width: 4px; }
.markdown-preview:not([data-use-github-style]) hr { margin: 3em 0px; border-top-width: 2px; border-top-style: dashed; border-top-color: rgb(214, 214, 214); background: none; }
.markdown-preview:not([data-use-github-style]) table { margin: 1.5em 0px; }
.markdown-preview:not([data-use-github-style]) th { color: rgb(3, 3, 3); }
.markdown-preview:not([data-use-github-style]) th, .markdown-preview:not([data-use-github-style]) td { padding: 0.66em 1em; border: 1px solid rgb(214, 214, 214); }
.markdown-preview:not([data-use-github-style]) code { color: rgb(3, 3, 3); background-color: rgb(240, 240, 240); }
.markdown-preview:not([data-use-github-style]) pre.editor-colors { margin: 1.5em 0px; padding: 1em; font-size: 0.92em; border-radius: 3px; background-color: rgb(245, 245, 245); }
.markdown-preview:not([data-use-github-style]) kbd { color: rgb(3, 3, 3); border-width: 1px 1px 2px; border-style: solid; border-color: rgb(214, 214, 214) rgb(214, 214, 214) rgb(199, 199, 199); background-color: rgb(240, 240, 240); }
.markdown-preview[data-use-github-style] { font-family: 'Helvetica Neue', Helvetica, 'Segoe UI', Arial, freesans, sans-serif; line-height: 1.6; word-wrap: break-word; padding: 30px; font-size: 16px; color: rgb(51, 51, 51); overflow: scroll; background-color: rgb(255, 255, 255); }
.markdown-preview[data-use-github-style] > :first-child { margin-top: 0px !important; }
.markdown-preview[data-use-github-style] > :last-child { margin-bottom: 0px !important; }
.markdown-preview[data-use-github-style] a:not([href]) { color: inherit; text-decoration: none; }
.markdown-preview[data-use-github-style] .absent { color: rgb(204, 0, 0); }
.markdown-preview[data-use-github-style] .anchor { position: absolute; top: 0px; left: 0px; display: block; padding-right: 6px; padding-left: 30px; margin-left: -30px; }
.markdown-preview[data-use-github-style] .anchor:focus { outline: none; }
.markdown-preview[data-use-github-style] h1, .markdown-preview[data-use-github-style] h2, .markdown-preview[data-use-github-style] h3, .markdown-preview[data-use-github-style] h4, .markdown-preview[data-use-github-style] h5, .markdown-preview[data-use-github-style] h6 { position: relative; margin-top: 1em; margin-bottom: 16px; font-weight: bold; line-height: 1.4; }
.markdown-preview[data-use-github-style] h1 .octicon-link, .markdown-preview[data-use-github-style] h2 .octicon-link, .markdown-preview[data-use-github-style] h3 .octicon-link, .markdown-preview[data-use-github-style] h4 .octicon-link, .markdown-preview[data-use-github-style] h5 .octicon-link, .markdown-preview[data-use-github-style] h6 .octicon-link { display: none; color: rgb(0, 0, 0); vertical-align: middle; }
.markdown-preview[data-use-github-style] h1:hover .anchor, .markdown-preview[data-use-github-style] h2:hover .anchor, .markdown-preview[data-use-github-style] h3:hover .anchor, .markdown-preview[data-use-github-style] h4:hover .anchor, .markdown-preview[data-use-github-style] h5:hover .anchor, .markdown-preview[data-use-github-style] h6:hover .anchor { padding-left: 8px; margin-left: -30px; text-decoration: none; }
.markdown-preview[data-use-github-style] h1:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h2:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h3:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h4:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h5:hover .anchor .octicon-link, .markdown-preview[data-use-github-style] h6:hover .anchor .octicon-link { display: inline-block; }
.markdown-preview[data-use-github-style] h1 tt, .markdown-preview[data-use-github-style] h2 tt, .markdown-preview[data-use-github-style] h3 tt, .markdown-preview[data-use-github-style] h4 tt, .markdown-preview[data-use-github-style] h5 tt, .markdown-preview[data-use-github-style] h6 tt, .markdown-preview[data-use-github-style] h1 code, .markdown-preview[data-use-github-style] h2 code, .markdown-preview[data-use-github-style] h3 code, .markdown-preview[data-use-github-style] h4 code, .markdown-preview[data-use-github-style] h5 code, .markdown-preview[data-use-github-style] h6 code { font-size: inherit; }
.markdown-preview[data-use-github-style] h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview[data-use-github-style] h1 .anchor { line-height: 1; }
.markdown-preview[data-use-github-style] h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); }
.markdown-preview[data-use-github-style] h2 .anchor { line-height: 1; }
.markdown-preview[data-use-github-style] h3 { font-size: 1.5em; line-height: 1.43; }
.markdown-preview[data-use-github-style] h3 .anchor { line-height: 1.2; }
.markdown-preview[data-use-github-style] h4 { font-size: 1.25em; }
.markdown-preview[data-use-github-style] h4 .anchor { line-height: 1.2; }
.markdown-preview[data-use-github-style] h5 { font-size: 1em; }
.markdown-preview[data-use-github-style] h5 .anchor { line-height: 1.1; }
.markdown-preview[data-use-github-style] h6 { font-size: 1em; color: rgb(119, 119, 119); }
.markdown-preview[data-use-github-style] h6 .anchor { line-height: 1.1; }
.markdown-preview[data-use-github-style] p, .markdown-preview[data-use-github-style] blockquote, .markdown-preview[data-use-github-style] ul, .markdown-preview[data-use-github-style] ol, .markdown-preview[data-use-github-style] dl, .markdown-preview[data-use-github-style] table, .markdown-preview[data-use-github-style] pre { margin-top: 0px; margin-bottom: 16px; }
.markdown-preview[data-use-github-style] hr { height: 4px; padding: 0px; margin: 16px 0px; border: 0px none; background-color: rgb(231, 231, 231); }
.markdown-preview[data-use-github-style] ul, .markdown-preview[data-use-github-style] ol { padding-left: 2em; }
.markdown-preview[data-use-github-style] ul.no-list, .markdown-preview[data-use-github-style] ol.no-list { padding: 0px; list-style-type: none; }
.markdown-preview[data-use-github-style] ul ul, .markdown-preview[data-use-github-style] ul ol, .markdown-preview[data-use-github-style] ol ol, .markdown-preview[data-use-github-style] ol ul { margin-top: 0px; margin-bottom: 0px; }
.markdown-preview[data-use-github-style] li > p { margin-top: 16px; }
.markdown-preview[data-use-github-style] dl { padding: 0px; }
.markdown-preview[data-use-github-style] dl dt { padding: 0px; margin-top: 16px; font-size: 1em; font-style: italic; font-weight: bold; }
.markdown-preview[data-use-github-style] dl dd { padding: 0px 16px; margin-bottom: 16px; }
.markdown-preview[data-use-github-style] blockquote { padding: 0px 15px; color: rgb(119, 119, 119); border-left-width: 4px; border-left-style: solid; border-left-color: rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] blockquote > :first-child { margin-top: 0px; }
.markdown-preview[data-use-github-style] blockquote > :last-child { margin-bottom: 0px; }
.markdown-preview[data-use-github-style] table { display: block; width: 100%; overflow: auto; word-break: keep-all; }
.markdown-preview[data-use-github-style] table th { font-weight: bold; }
.markdown-preview[data-use-github-style] table th, .markdown-preview[data-use-github-style] table td { padding: 6px 13px; border: 1px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] table tr { border-top-width: 1px; border-top-style: solid; border-top-color: rgb(204, 204, 204); background-color: rgb(255, 255, 255); }
.markdown-preview[data-use-github-style] table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
.markdown-preview[data-use-github-style] img { max-width: 100%; box-sizing: border-box; }
.markdown-preview[data-use-github-style] .emoji { max-width: none; }
.markdown-preview[data-use-github-style] span.frame { display: block; overflow: hidden; }
.markdown-preview[data-use-github-style] span.frame > span { display: block; float: left; width: auto; padding: 7px; margin: 13px 0px 0px; overflow: hidden; border: 1px solid rgb(221, 221, 221); }
.markdown-preview[data-use-github-style] span.frame span img { display: block; float: left; }
.markdown-preview[data-use-github-style] span.frame span span { display: block; padding: 5px 0px 0px; clear: both; color: rgb(51, 51, 51); }
.markdown-preview[data-use-github-style] span.align-center { display: block; overflow: hidden; clear: both; }
.markdown-preview[data-use-github-style] span.align-center > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: center; }
.markdown-preview[data-use-github-style] span.align-center span img { margin: 0px auto; text-align: center; }
.markdown-preview[data-use-github-style] span.align-right { display: block; overflow: hidden; clear: both; }
.markdown-preview[data-use-github-style] span.align-right > span { display: block; margin: 13px 0px 0px; overflow: hidden; text-align: right; }
.markdown-preview[data-use-github-style] span.align-right span img { margin: 0px; text-align: right; }
.markdown-preview[data-use-github-style] span.float-left { display: block; float: left; margin-right: 13px; overflow: hidden; }
.markdown-preview[data-use-github-style] span.float-left span { margin: 13px 0px 0px; }
.markdown-preview[data-use-github-style] span.float-right { display: block; float: right; margin-left: 13px; overflow: hidden; }
.markdown-preview[data-use-github-style] span.float-right > span { display: block; margin: 13px auto 0px; overflow: hidden; text-align: right; }
.markdown-preview[data-use-github-style] code, .markdown-preview[data-use-github-style] tt { padding: 0.2em 0px; margin: 0px; font-size: 85%; border-radius: 3px; background-color: rgba(0, 0, 0, 0.0392157); }
.markdown-preview[data-use-github-style] code::before, .markdown-preview[data-use-github-style] tt::before, .markdown-preview[data-use-github-style] code::after, .markdown-preview[data-use-github-style] tt::after { letter-spacing: -0.2em; content: " "; }
.markdown-preview[data-use-github-style] code br, .markdown-preview[data-use-github-style] tt br { display: none; }
.markdown-preview[data-use-github-style] del code { text-decoration: inherit; }
.markdown-preview[data-use-github-style] pre > code { padding: 0px; margin: 0px; font-size: 100%; word-break: normal; white-space: pre; border: 0px; background: transparent; }
.markdown-preview[data-use-github-style] .highlight { margin-bottom: 16px; }
.markdown-preview[data-use-github-style] .highlight pre, .markdown-preview[data-use-github-style] pre { padding: 16px; overflow: auto; font-size: 85%; line-height: 1.45; border-radius: 3px; background-color: rgb(247, 247, 247); }
.markdown-preview[data-use-github-style] .highlight pre { margin-bottom: 0px; word-break: normal; }
.markdown-preview[data-use-github-style] pre { word-wrap: normal; }
.markdown-preview[data-use-github-style] pre code, .markdown-preview[data-use-github-style] pre tt { display: inline; max-width: initial; padding: 0px; margin: 0px; overflow: initial; line-height: inherit; word-wrap: normal; border: 0px; background-color: transparent; }
.markdown-preview[data-use-github-style] pre code::before, .markdown-preview[data-use-github-style] pre tt::before, .markdown-preview[data-use-github-style] pre code::after, .markdown-preview[data-use-github-style] pre tt::after { content: normal; }
.markdown-preview[data-use-github-style] kbd { display: inline-block; padding: 3px 5px; font-size: 11px; line-height: 10px; color: rgb(85, 85, 85); vertical-align: middle; border-style: solid; border-width: 1px; border-color: rgb(204, 204, 204) rgb(204, 204, 204) rgb(187, 187, 187); border-radius: 3px; box-shadow: rgb(187, 187, 187) 0px -1px 0px inset; background-color: rgb(252, 252, 252); }
.markdown-preview[data-use-github-style] a { color: rgb(51, 122, 183); }
.markdown-preview[data-use-github-style] code { color: inherit; }
.markdown-preview[data-use-github-style] pre.editor-colors { padding: 0.8em 1em; margin-bottom: 1em; font-size: 0.85em; border-radius: 4px; overflow: auto; }
.scrollbars-visible-always .markdown-preview pre.editor-colors::shadow .vertical-scrollbar, .scrollbars-visible-always .markdown-preview pre.editor-colors::shadow .horizontal-scrollbar { visibility: hidden; }
.scrollbars-visible-always .markdown-preview pre.editor-colors:hover::shadow .vertical-scrollbar, .scrollbars-visible-always .markdown-preview pre.editor-colors:hover::shadow .horizontal-scrollbar { visibility: visible; }
.markdown-preview code { text-shadow: none; }
.bracket-matcher .region {
  border-bottom: 1px dotted lime;
  position: absolute;
}

.spell-check-misspelling .region {
  border-bottom: 2px dotted rgba(255, 51, 51, 0.75);
}

pre.editor-colors,
.host {
  background-color: #ffffff;
  color: #555555;
}
pre.editor-colors .invisible-character,
.host .invisible-character {
  color: rgba(85, 85, 85, 0.2);
}
pre.editor-colors .indent-guide,
.host .indent-guide {
  color: rgba(85, 85, 85, 0.2);
}
pre.editor-colors .wrap-guide,
.host .wrap-guide {
  background-color: rgba(85, 85, 85, 0.2);
}
pre.editor-colors .gutter,
.host .gutter {
  color: #555555;
  background: #ffffff;
}
pre.editor-colors .gutter .line-number.folded,
.host .gutter .line-number.folded,
pre.editor-colors .gutter .line-number:after,
.host .gutter .line-number:after,
pre.editor-colors .fold-marker:after,
.host .fold-marker:after {
  color: #e87b00;
}
pre.editor-colors .invisible,
.host .invisible {
  color: #555;
}
pre.editor-colors .selection .region,
.host .selection .region {
  background-color: #e1e1e1;
}
pre.editor-colors.is-focused .cursor,
.host.is-focused .cursor {
  border-color: #000000;
}
pre.editor-colors.is-focused .selection .region,
.host.is-focused .selection .region {
  background-color: #afc4da;
}
pre.editor-colors.is-focused .line-number.cursor-line-no-selection,
.host.is-focused .line-number.cursor-line-no-selection,
pre.editor-colors.is-focused .line.cursor-line,
.host.is-focused .line.cursor-line {
  background-color: rgba(255, 255, 134, 0.34);
}
pre.editor-colors .source.gfm,
.host .source.gfm {
  color: #444;
}
pre.editor-colors .gfm .markup.heading,
.host .gfm .markup.heading {
  color: #111;
}
pre.editor-colors .gfm .link,
.host .gfm .link {
  color: #888;
}
pre.editor-colors .gfm .variable.list,
.host .gfm .variable.list {
  color: #888;
}
pre.editor-colors .markdown .paragraph,
.host .markdown .paragraph {
  color: #444;
}
pre.editor-colors .markdown .heading,
.host .markdown .heading {
  color: #111;
}
pre.editor-colors .markdown .link,
.host .markdown .link {
  color: #888;
}
pre.editor-colors .markdown .link .string,
.host .markdown .link .string {
  color: #888;
}
.host(.is-focused) .cursor {
  border-color: #000000;
}
.host(.is-focused) .selection .region {
  background-color: #afc4da;
}
.host(.is-focused) .line-number.cursor-line-no-selection,
.host(.is-focused) .line.cursor-line {
  background-color: rgba(255, 255, 134, 0.34);
}
.comment {
  color: #999988;
  font-style: italic;
}
.string {
  color: #D14;
}
.string .source,
.string .meta.embedded.line {
  color: #5A5A5A;
}
.string .punctuation.section.embedded {
  color: #920B2D;
}
.string .punctuation.section.embedded .source {
  color: #920B2D;
}
.constant.numeric {
  color: #D14;
}
.constant.language {
  color: #606aa1;
}
.constant.character,
.constant.other {
  color: #606aa1;
}
.constant.symbol {
  color: #990073;
}
.constant.numeric.line-number.find-in-files .match {
  color: rgba(143, 190, 0, 0.63);
}
.variable {
  color: #008080;
}
.variable.parameter {
  color: #606aa1;
}
.keyword {
  color: #222;
  font-weight: bold;
}
.keyword.unit {
  color: #445588;
}
.keyword.special-method {
  color: #0086B3;
}
.storage {
  color: #222;
}
.storage.type {
  color: #222;
}
.entity.name.class {
  text-decoration: underline;
  color: #606aa1;
}
.entity.other.inherited-class {
  text-decoration: underline;
  color: #606aa1;
}
.entity.name.function {
  color: #900;
}
.entity.name.tag {
  color: #008080;
}
.entity.other.attribute-name {
  color: #458;
  font-weight: bold;
}
.entity.name.filename.find-in-files {
  color: #E6DB74;
}
.support.constant,
.support.function,
.support.type {
  color: #458;
}
.support.class {
  color: #008080;
}
.invalid {
  color: #F8F8F0;
  background-color: #00A8C6;
}
.invalid.deprecated {
  color: #F8F8F0;
  background-color: #8FBE00;
}
.meta.structure.dictionary.json > .string.quoted.double.json,
.meta.structure.dictionary.json > .string.quoted.double.json .punctuation.string {
  color: #000080;
}
.meta.structure.dictionary.value.json > .string.quoted.double.json {
  color: #d14;
}
.meta.diff,
.meta.diff.header {
  color: #75715E;
}
.css.support.property-name {
  font-weight: bold;
  color: #333;
}
.css.constant {
  color: #099;
}
.bracket-matcher .region {
  background-color: #C9C9C9;
  opacity: .7;
  border-bottom: 0 none;
}
</style>
  </head>
  <body class='markdown-preview'><h1 style="text-align: center;" markdown="1">Data Science for fraud detection</h1>

<div style="text-align: center;" markdown="1"><font size="5">
A complete predictive modeling project in Python
</font><br><font size="4">
Part II: Feature engineering: sorting out the valuable information<br></font><br></div>  

<div style="text-align: center;" markdown="1"> <font size="0.7">
<img src="http://mbesancon.github.io/BankNotes/images/svmexample.png" alt="Feature engineering for SVM" style="width: 400px;">
</font></div>
<div style="text-align: right;" markdown="1"> <font size="0.7">
[1]
</font><br></div>

<hr>
<h2 id="articles">Articles</h2>
<p><a href="article.html">Part I: Preprocessing and exploratory analysis
</a><br><a href="feature_eng.html">Part II: Feature engineering
</a><br><a href="model.html">Part III: Model development
</a></p>
<p>To follow the following article without any trouble, I would recommend to
start with the beginning.</p>
<hr>
<h2 id="-table-of-contents-"><strong>Table of Contents</strong></h2>
<p><em>generated with <a href="http://doctoc.herokuapp.com/">DocToc</a></em></p>
<ul>
<li><a href="#">What is feature engineering?</a></li>
<li><a href="#">Correlated variables</a><ul>
<li><a href="#">Simple linear and polynomial regression</a></li>
<li><a href="#">Advantages and risks</a></li>
</ul>
</li>
<li><a href="#">Feature engineering pipeline</a></li>
</ul>
<h1 id="what-is-feature-engineering-">What is feature engineering?</h1>
<p>It could be describe as the transformation of raw data to produce
a model input which will have better performance. The <em>features</em> are
the new variables created in the process.<br>It is often described as based on domain knowledge and more of an
art than of a science. Therefore, it requires a great attention and
a more &quot;manual&quot; process than the rest of data science projects.  </p>
<p>Feature engineering tends to be heavier when raw data are far from
the expected input format of our learning models
(images or text for instance). It can be noticed that some feature
engineering was already performed on our data, since banknotes were
registered as images taken from a digital camera, and we only received
5 features for each image.</p>
<h1 id="correlated-variables">Correlated variables</h1>
<h2 id="simple-linear-and-polynomial-regression">Simple linear and polynomial regression</h2>
<p>We noticed some strong dependencies between variables thanks to the
scatter plot. Those can deter the performance and robustness of
several machine learning models. Skewness and kurtosis seem to be
somehow related. A regression line can be fitted with the skewness as
explanatory variable:</p>
<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span>a</span><span>,&nbsp;</span><span>b</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>stats</span><span>.</span><span>linregress</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>kurtosis</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span class="meta structure list python"><span class="punctuation definition list begin python"><span>[</span></span><span class="meta structure list item python"><span>:</span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition list end python"><span>]</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>kurtosis</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>g+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric float python"><span>2.5</span></span><span>,</span><span class="constant numeric float python"><span>2.5</span></span><span>,</span><span class="constant numeric float python"><span>0.05</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span>&nbsp;,</span><span>b</span><span class="keyword operator arithmetic python"><span>+</span></span><span>a</span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric float python"><span>2.5</span></span><span>,</span><span class="constant numeric float python"><span>2.5</span></span><span>,</span><span class="constant numeric float python"><span>0.05</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>r</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>title</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>Simple&nbsp;linear&nbsp;regression</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>xlabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>Skewness</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>ylabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>Kurtosis</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>show</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<p><img src="http://mbesancon.github.io/BankNotes/figures/linear_reg.png" alt="Linear regression" style="width: 600px;"></p>
<p>The following result highlights a lack in the model. The slope and intercept
seem to be biased by a dense cluster of points with the skewness
between 1 and 2. The points with a low skewness are under-represented in the
model and do not follow the trend of the regression line. A robust regression
technique could correct this bias, but a polynomial regression is the most
straight-forward method to capture a higher part of the variance here.
The second-degree polynomial model can be written as:</p>
<div style="text-align: center;" markdown="1"> <font size="0.7">
<img src="http://bit.ly/1K6AIoI" align="center" border="0" alt="a\cdot x^2 + b\cdot x + c" width="129" height="19"><br></font><br></div>
and can be found through least-square model in numpy:
<code>python
a, b, c = np.polyfit(data0[&quot;skew&quot;],data0[&quot;kurtosis&quot;],deg=2)
plt.plot(data0[&quot;skew&quot;],data0[&quot;kurtosis&quot;],&#39;+&#39;)
plt.plot(np.arange(-15,15,.5),
a*np.arange(-15,15,.5)*np.arange(-15,15,.5),&#39;r&#39;)+b*np.arange(-15,15,.5)+c
plt.title(&#39;2nd degree polynomial regression&#39;)
plt.xlabel(&#39;Skewness&#39;)
plt.ylabel(&#39;Kurtosis&#39;)</code>
<div style="text-align: center;" markdown="1"> <font size="0.7">
<img src="http://mbesancon.github.io/BankNotes/figures/poly_reg.png" alt="Polynomial regression" style="width: 600px;">
</font></div>
A polynomial regression yields a much better output with balanced residuals.
The p-value for all coefficients is below the 1% confidence criterion.
One strong drawback can however be noticed: the polynomial model predicts an
increase in the kurtosis for skewness superior to 2, but there is no evidence
for this statement in our data, so the model could lead to stronger errors.<br><p>
</p>

The regression does not capture all the variance (and does not explain all
underlying phenomena) of the Kurtosis, so a transformed variable has to be kept,
which should be independent from the skewness. The most obvious value is the
residual of the polynomial regression we performed.

<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://bit.ly/1K6B7aQ" align="center" border="0" alt="e_i = \hat{y}_i - y_i = a\cdot x_i^2 + b\cdot x_i + c - y_i" width="276" height="26">
</font></div>  

<p>We can represent this residual versus the explanatory variable
to be assured that:  </p>
<ul>
<li>The residuals are centered around 0</li>
<li>The variance of the residuals is approximately constant with the skewness</li>
<li>There are still patterns in the Kurtosis: the residuals are not just noise</li>
</ul>
<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span>p0</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>plt</span><span>.</span><span>scatter</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span>c</span><span class="keyword operator arithmetic python"><span>+</span></span><span>b</span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator arithmetic python"><span>+</span></span><span>a</span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>kurtosis</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>c</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>b</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span class="punctuation separator parameters python"><span>,</span></span><span class="variable parameter function python"><span>marker</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span class="punctuation separator parameters python"><span>,</span></span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>p0</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>plt</span><span>.</span><span>scatter</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span>c</span><span class="keyword operator arithmetic python"><span>+</span></span><span>b</span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator arithmetic python"><span>+</span></span><span>a</span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>kurtosis</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>c</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>r</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span class="punctuation separator parameters python"><span>,</span></span><span class="variable parameter function python"><span>marker</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span class="punctuation separator parameters python"><span>,</span></span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>title</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>Explanatory&nbsp;variable&nbsp;vs&nbsp;Regression&nbsp;residuals</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>xlabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>Skewness</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>ylabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>Residuals</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>legend</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta structure list python"><span class="punctuation definition list begin python"><span>[</span></span><span class="meta structure list item python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span class="meta structure list item python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition list end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>show</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://mbesancon.github.io/BankNotes/figures/resid_reg.png" alt="Residuals of the regression" style="width: 400px;">
</font></div>

<p>The data is now much more uncorrelated, so the feature of interest is the
residual of the regression which will replace the kurtosis in the data.</p>
<h2 id="class-dependent-regression">Class-dependent regression</h2>
<p>We can try and repeat the same process for the entropy and skewness, which
also seem to be related to each other.</p>
<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>r+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>xlabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Skewness</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>ylabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>grid</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>legend</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>show</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://mbesancon.github.io/BankNotes/figures/skew_entropy.png" alt="Skewness-Entropy" style="width: 400px;"><br></font></div>

<p>We can try can fit a 2nd-degree polynomial function:</p>
<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span>ft</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>polyfit</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>deg</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>r+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric integer decimal python"><span>15</span></span><span>,</span><span class="constant numeric float python"><span>14.5</span></span><span>,</span><span class="constant numeric float python"><span>.5</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span>,</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span class="meta function-call arguments python"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta item-access python"><span>ft</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric integer decimal python"><span>15</span></span><span>,</span><span class="constant numeric float python"><span>14.5</span></span><span>,</span><span class="constant numeric float python"><span>.5</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric integer decimal python"><span>15</span></span><span>,</span><span class="constant numeric float python"><span>14.5</span></span><span>,</span><span class="constant numeric float python"><span>.5</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span class="keyword operator arithmetic python"><span>+</span></span><span class="meta item-access python"><span>ft</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span class="meta function-call arguments python"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric integer decimal python"><span>15</span></span><span>,</span><span class="constant numeric float python"><span>14.5</span></span><span>,</span><span class="constant numeric float python"><span>.5</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span class="keyword operator arithmetic python"><span>+</span></span><span class="meta item-access python"><span>ft</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>-</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>linewidth</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span><span>&nbsp;</span><span class="punctuation separator parameters python"><span>,</span></span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span class="meta function-call arguments python"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Fitted&nbsp;polynom</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>xlabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Skewness</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>ylabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>grid</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>legend</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="variable parameter function python"><span>loc</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>bottom&nbsp;center</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>show</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://mbesancon.github.io/BankNotes/figures/fit1_entropy.png" alt="Polynomial regression on entropy" style="width: 400px;">
</font></div>  

<p>However, it seems that the model does not fit well our data and that the points
are not equally distributed on both side of the curve. There is another
pattern, which is class-dependent, so two polynomial curves should be fitted:</p>
<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;Class&nbsp;dependent&nbsp;polynomial&nbsp;regression</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>f0</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>polyfit</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>deg</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>x</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>arange</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="keyword operator arithmetic python"><span>-</span></span><span class="constant numeric integer decimal python"><span>15</span></span><span>,</span><span class="constant numeric integer decimal python"><span>14</span></span><span>,</span><span class="constant numeric float python"><span>.5</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>f1</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>polyfit</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>deg</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span>x</span><span>,</span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span>x</span><span class="keyword operator arithmetic python"><span>*</span></span><span>x</span><span class="keyword operator arithmetic python"><span>+</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span>x</span><span class="keyword operator arithmetic python"><span>+</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>-</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Fitted&nbsp;0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>alpha</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric float python"><span>.7</span></span><span class="punctuation separator parameters python"><span>,</span></span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span>x</span><span>,</span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span>x</span><span class="keyword operator arithmetic python"><span>*</span></span><span>x</span><span class="keyword operator arithmetic python"><span>+</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span>x</span><span class="keyword operator arithmetic python"><span>+</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>-</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Fitted&nbsp;1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>m+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>alpha</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric float python"><span>.7</span></span><span class="punctuation separator parameters python"><span>,</span></span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>title</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;dependent&nbsp;fit</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>xlabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Skewness</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>ylabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>grid</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>legend</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="variable parameter function python"><span>loc</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>bottom&nbsp;center</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>savefig</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>class_depend.png</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>show</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://mbesancon.github.io/BankNotes/figures/class_depend.png" alt="Class-dependent polynomial regression" style="width: 400px;"><br></font></div>
The model seems to capture more of the variance in our data, which we can
confirm by plotting the residuals of the class-dependent regression.

<code>python
# residuals of the class-dependent model
plt.plot(d0[&quot;skew&quot;],f0[0]*d0[&quot;skew&quot;]*d0[&quot;skew&quot;]+f0[1]*d0[&quot;skew&quot;]+
        f0[2]-d0[&quot;entropy&quot;],&#39;b+&#39;,label=&quot;Class 0&quot;)
plt.plot(d1[&quot;skew&quot;],f1[0]*d1[&quot;skew&quot;]*d1[&quot;skew&quot;]+f1[1]*d1[&quot;skew&quot;]+
        f1[2]-d1[&quot;entropy&quot;],&#39;r+&#39;,label=&quot;Class 1&quot;)
plt.legend()
plt.grid()
plt.xlabel(&quot;Skewness&quot;)
plt.ylabel(&quot;Residuals&quot;)
plt.savefig(&quot;res_class_dep.png&quot;)
plt.show()</code>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://mbesancon.github.io/BankNotes/figures/res_class_dep.png" alt="Residuals of the class-dependent polynomial regression" style="width: 400px;"><br></font></div>
We have a proper working model, with just one problem: <strong>we used
the class to predict the entropy</strong> whereas our classification
objective is to proceed the other way around. Since we noticed
that each class follows a different curve, a difference between
the distance to the first model and the distance to the second
model, which will be noted &quot;d&quot;, can be computed as:

<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://bit.ly/1SaWPlD" align="center" border="0" alt="d_i = |{(y_i - f_0(x_i)| - |y_i - f_1(x_i)|" width="246" height="19">
</font>
</div>

<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span>d</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span class="support function builtin python"><span>abs</span></span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="punctuation separator continuation line python"><span>\</span></span><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call python"><span class="support function builtin python"><span>abs</span></span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta item-access python"><span>d</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>class</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator comparison python"><span>==</span></span><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span></div><div class="line"><span class="source python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta item-access python"><span>d</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>class</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator comparison python"><span>==</span></span><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>grid</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>b+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;0</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>plot</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>r+</span><span class="punctuation definition string end python"><span>&#39;</span></span></span><span>,</span><span class="variable parameter function python"><span>label</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Class&nbsp;1</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>legend</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>title</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d&nbsp;vs&nbsp;skewness&nbsp;for&nbsp;each&nbsp;class</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>xlabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>Skewness</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>ylabel</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span class="meta function-call python"><span>plt</span><span>.</span><span>show</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://mbesancon.github.io/BankNotes/figures/d_skew.png" alt="d vs skewness by class" style="width: 400px;"><br></font></div>

<p>A positive &quot;d&quot; value indicates that the entropy of the observation
is closer to the model fitted on the class 1, this seems to be a
rather relevant indicator to use to build our models. However, this
variable seems correlated to the skewness. The latter could have become
unnecessary for our prediction, so we choose to eliminate it from
the features and take the risk of an information loss.</p>
<h1 id="variable-scaling">Variable scaling</h1>
<h2 id="common-scaling-techniques">Common scaling techniques</h2>
<p>Very different spreads could be noticed among variables during the exploratory
part. This can lead to a bias in the distance between two points. A possible
solution to this is <strong>scaling</strong> or <strong>standardization</strong>.</p>
<ul>
<li><strong>Variance scaling</strong> of a variable is the division of each value by the
variable standard deviation. The output is a variable with variance 1.</li>
</ul>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://bit.ly/1SaVU4S" align="center" border="0" alt="x_{j, scal.} = \frac{x_j}{\sigma_j}" width="92" height="44">
</font>
</div>

<ul>
<li><strong>Min-Max standardization</strong> of a variable is the division of each value by
the difference between the maximum and minimum values. The outcome values
are all contained in the interval [0,1].  </li>
</ul>
<div style="text-align: center;" markdown="1"><font size="3">
<img src="http://bit.ly/1mNGxSz" align="center" border="0" alt="x_{j, stand} = \frac{x_j}{max(x_j)-min(x_j)}" width="232" height="44"><br></font>
</div>

<p>Other standardization operations exist, but those are the
most common because of the properties highlighted.</p>
<h2 id="advantages-and-risks">Advantages and risks</h2>
<p>Scaling variables may avoid the distance between data points
to be over-influenced by high-variance variables, because
the ability to classify the data points from a variable
is usually not proportional to the variable variance.  </p>
<p>Furthermore, all people with notions in physics and calculus
would find it awkward to compute a distance from heterogeneous
variables (which would have different units and meaning).</p>
<p>However, scaling might increase the weight of variables carrying mostly
or only noise, to which the model would fit, increasing the error on
new data.</p>
<p>For this case, the second risk seems very low: all variables seem to
carry information, which we could observe because of the low number of
variables.</p>
<h1 id="feature-engineering-pipeline">Feature engineering pipeline</h1>
<pre class="editor-colors lang-python"><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;Fitting&nbsp;a&nbsp;polynomial&nbsp;model&nbsp;between&nbsp;the&nbsp;skew&nbsp;and&nbsp;kurtosis</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>a</span><span>,&nbsp;</span><span>b</span><span>,&nbsp;</span><span>c</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>polyfit</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>kurtosis</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>deg</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;copying&nbsp;the&nbsp;data</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>data1</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>data0</span><span>.</span><span>copy</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;computing&nbsp;the&nbsp;residual&nbsp;of&nbsp;the&nbsp;regression&nbsp;against&nbsp;kurtosis</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>data1</span><span>.</span><span>columns</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta structure list python"><span class="punctuation definition list begin python"><span>[</span></span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>vari</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>k_resid</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>class</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition list end python"><span>]</span></span></span></span></div><div class="line"><span class="source python"><span class="meta item-access python"><span>data1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>k_resid</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>kurtosis</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator arithmetic python"><span>-</span></span><span>&nbsp;</span><span>(</span><span>a</span><span class="keyword operator arithmetic python"><span>*</span></span><span>(</span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>)</span><span class="keyword operator arithmetic python"><span>*</span><span>*</span></span><span class="constant numeric integer decimal python"><span>2</span></span><span>&nbsp;</span><span class="keyword operator arithmetic python"><span>+</span></span><span>&nbsp;</span><span>b</span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator arithmetic python"><span>+</span></span><span>&nbsp;</span><span>c</span><span>)</span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;computing&nbsp;the&nbsp;feature&nbsp;from&nbsp;the&nbsp;entropy&nbsp;regression</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>data1</span><span>.</span><span>columns</span><span>&nbsp;&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta structure list python"><span class="punctuation definition list begin python"><span>[</span></span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>vari</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>k_resid</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>d</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation separator list python"><span>,</span></span><span>&nbsp;</span><span class="meta structure list item python"><span class="string quoted single single-line python"><span class="punctuation definition string begin python"><span>&#39;</span></span><span>class</span><span class="punctuation definition string end python"><span>&#39;</span></span></span></span><span class="punctuation definition list end python"><span>]</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;Class-dependent&nbsp;model</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>f0</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>polyfit</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>deg</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>f1</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>np</span><span>.</span><span>polyfit</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="meta item-access python"><span>d1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>,</span><span class="variable parameter function python"><span>deg</span></span><span class="keyword operator assignment python"><span>=</span></span><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="meta item-access python"><span>data1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>d</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span class="support function builtin python"><span>abs</span></span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="punctuation separator continuation line python"><span>\</span></span><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta function-call python"><span class="support function builtin python"><span>abs</span></span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>entropy</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>0</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>*</span></span><span class="meta item-access python"><span>data0</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>-</span></span><span class="meta item-access python"><span>f1</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span class="constant numeric integer decimal python"><span>2</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;removing&nbsp;skew</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span>data1</span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta function-call python"><span>data1</span><span>.</span><span>drop</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="string quoted double single-line python"><span class="punctuation definition string begin python"><span>&quot;</span></span><span>skew</span><span class="punctuation definition string end python"><span>&quot;</span></span></span><span>,</span><span class="constant numeric integer decimal python"><span>1</span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div><div class="line"><span class="source python"><span>&nbsp;</span></span></div><div class="line"><span class="source python"><span class="comment line number-sign python"><span class="punctuation definition comment python"><span>#</span></span><span>&nbsp;data&nbsp;normalization</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source python"><span class="meta item-access python"><span>data1</span><span>.</span><span>iloc</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span>:,:</span><span class="constant numeric integer decimal python"><span>4</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span>&nbsp;</span><span class="keyword operator assignment python"><span>=</span></span><span>&nbsp;</span><span class="meta item-access python"><span>data1</span><span>.</span><span>iloc</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span>:,:</span><span class="constant numeric integer decimal python"><span>4</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span><span class="keyword operator arithmetic python"><span>/</span></span><span class="meta function-call python"><span>np</span><span>.</span><span>sqrt</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta function-call python"><span>np</span><span>.</span><span>var</span><span class="punctuation definition arguments begin python"><span>(</span></span><span class="meta function-call arguments python"><span class="meta item-access python"><span>data1</span><span>.</span><span>iloc</span><span class="punctuation definition arguments begin python"><span>[</span></span><span class="meta item-access arguments python"><span>:,:</span><span class="constant numeric integer decimal python"><span>4</span></span></span><span class="punctuation definition arguments end python"><span>]</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span><span class="punctuation definition arguments end python"><span>)</span></span></span></span></div></pre>
<p><code>data1</code> can now be used in the next step which will consist in the
implementation of a basic machine learning algorithm. This is the key
part in an analysis-oriented data science project, and I hope to see you
<a href="model.html">there</a>.</p>
<hr>
<p>Get in touch at mathieu(dot)besancon(at)gmail.com, on
my personal <a href="mathieu-besancon.strikingly.com">website</a>
<a href="github.com/mbesancon">Github</a>,
<a href="https://www.quora.com/profile/Mathieu-Besan&#xE7;on">Quora</a>,
<a href="https://fr.linkedin.com/in/mbesancon/en">Linkedin</a>
or <a href="https://twitter.com/MathieuBesancon">Twitter</a></p>
<p><font size="0.7">
[1] Image source: Philipp Wagner: Machine Learning with OpenCV2
 </font></p></body>
</html>
